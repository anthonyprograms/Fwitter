angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope",function(o){o.$on("login",function(t,n){o.currentUser=n})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","$location",function(o,t,n){o.login=function(e,r){t.login(e,r).then(function(t){o.$emit("login",t.data),n.path("/")})},o.logout=function(){console.log("logout")}}]),angular.module("app").controller("LogoutCtrl",["$scope",function(o){o.logout=function(){console.log("logout"),o.currentUser=null}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(o,t){o.addPost=function(){o.postBody&&t.create({username:"anthonyprograms",body:o.postBody}).success(function(t){o.postBody=null})},t.fetch().success(function(t){o.posts=t}),o.$on("ws:new_post",function(t,n){o.$apply(function(){o.posts.unshift(n)})})}]),angular.module("app").service("PostsSvc",["$http",function(o){this.fetch=function(){return o.get("/api/posts")},this.create=function(t){return o.post("/api/posts",t)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc","$location",function(o,t,n){o.register=function(e,r){t.register(e,r).then(function(t){o.$emit("login",t),n.path("/login")})}}]),angular.module("app").config(["$routeProvider",function(o){o.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(o){var t=this;t.getUser=function(){return o.get("/api/users")},t.login=function(n,e){return o.post("/api/sessions",{username:n,password:e}).then(function(n){return t.token=n.data,o.defaults.headers.common["X-Auth"]=n.data,t.getUser()})},t.register=function(n,e){return o.post("/api/users",{username:n,password:e}).then(function(){return t.login(n,e)})}}]),angular.module("app").service("WebSocketSvc",["$rootScope",function(o){function t(){return"https:"===window.location.protocol?"wss://"+window.location.host:"ws://"+window.location.host}var n;this.connect=function(){n=new WebSocket(t()),n.onmessage=function(t){var n=JSON.parse(t.data);o.$broadcast("ws:"+n.topic,n.data)}},this.send=function(o,t){var e=JSON.strigify({topic:o,data:t});n.send(e)}}]).run(["WebSocketSvc",function(o){o.connect()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwibG9nb3V0LmN0cmwuanMiLCJwb3N0cy5jdHJsLmpzIiwicG9zdHMuc3ZjLmpzIiwicmVnaXN0ZXIuY3RybC5qcyIsInJvdXRlcy5qcyIsInVzZXIuc3ZjLmpzIiwid2Vic29ja2V0cy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJVc2VyU3ZjIiwiJGxvY2F0aW9uIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsInJlc3BvbnNlIiwiJGVtaXQiLCJkYXRhIiwicGF0aCIsImxvZ291dCIsImNvbnNvbGUiLCJsb2ciLCJQb3N0c1N2YyIsImFkZFBvc3QiLCJwb3N0Qm9keSIsImNyZWF0ZSIsImJvZHkiLCJzdWNjZXNzIiwicG9zdCIsImZldGNoIiwicG9zdHMiLCIkYXBwbHkiLCJ1bnNoaWZ0Iiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsInJlZ2lzdGVyIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJzdmMiLCJnZXRVc2VyIiwidmFsIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCIkcm9vdFNjb3BlIiwid2Vic29ja2V0SG9zdCIsIndpbmRvdyIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJob3N0IiwiY29ubmVjdGlvbiIsImNvbm5lY3QiLCJXZWJTb2NrZXQiLCJvbm1lc3NhZ2UiLCJlIiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsIiRicm9hZGNhc3QiLCJ0b3BpYyIsInNlbmQiLCJqc29uIiwic3RyaWdpZnkiLCJydW4iLCJXZWJTb2NrZXRTdmMiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLE9BQ0EsWUNEQUQsUUFBQUMsT0FBQSxPQUNBQyxX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QUgsRUFBQTFDLEtBQ0FnQyxHQUFBYyxXQUFBLE1BQUFILEVBQUFJLE1BQUFKLEVBQUEzQyxRQUdBa0IsS0FBQThCLEtBQUEsU0FBQUQsRUFBQS9DLEdBQ0EsR0FBQWlELEdBQUFMLEtBQUFNLFVBQUFILE1BQUFBLEVBQUEvQyxLQUFBQSxHQUNBc0MsR0FBQVUsS0FBQUMsT0FFQUUsS0FBQSxlQUFBLFNBQUFDLEdBQ0FBLEVBQUFiIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICAgJ25nUm91dGUnXG5dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24gKCRzY29wZSkge1xuICAgICRzY29wZS4kb24oJ2xvZ2luJywgZnVuY3Rpb24gKF8sIHVzZXIpIHtcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxuICAgIH0pXG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2YywgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgICBVc2VyU3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ2xvZ2luJywgcmVzcG9uc2UuZGF0YSlcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJylcbiAgICAgICAgfSlcbiAgICB9XG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2xvZ291dCcpXG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0xvZ291dEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlKSB7XG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2xvZ291dCcpXG4gICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IG51bGxcbiAgICB9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignUG9zdHNDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgUG9zdHNTdmMpIHtcbiAgICAkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCRzY29wZS5wb3N0Qm9keSkge1xuICAgICAgICAgICAgUG9zdHNTdmMuY3JlYXRlKHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogJ2FudGhvbnlwcm9ncmFtcycsXG4gICAgICAgICAgICAgICAgYm9keTogJHNjb3BlLnBvc3RCb2R5XG4gICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBvc3RCb2R5ID0gbnVsbFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIFBvc3RzU3ZjLmZldGNoKCkuc3VjY2VzcyhmdW5jdGlvbiAocG9zdHMpIHtcbiAgICAgICAgJHNjb3BlLnBvc3RzID0gcG9zdHNcbiAgICB9KVxuICAgICRzY29wZS4kb24oJ3dzOm5ld19wb3N0JywgZnVuY3Rpb24gKF8sIHBvc3QpIHtcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KVxuICAgICAgICB9KVxuICAgIH0pXG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnUG9zdHNTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcbiAgICB0aGlzLmZldGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJylcbiAgICB9XG4gICAgdGhpcy5jcmVhdGUgPSBmdW5jdGlvbiAocG9zdCkge1xuICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpXG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMsICRsb2NhdGlvbikge1xuICAgICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgVXNlclN2Yy5yZWdpc3Rlcih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlcilcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKVxuICAgICAgICB9KVxuICAgIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgJHJvdXRlUHJvdmlkZXJcbiAgICAud2hlbignLycsIHsgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCcgfSlcbiAgICAud2hlbignL3JlZ2lzdGVyJywge2NvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLCB0ZW1wbGF0ZVVybDogJ3JlZ2lzdGVyLmh0bWwnIH0pXG4gICAgLndoZW4oJy9sb2dpbicsIHtjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJyB9KVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1VzZXJTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcbiAgICB2YXIgc3ZjID0gdGhpc1xuICAgIHN2Yy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJylcbiAgICB9XG4gICAgc3ZjLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgc3ZjLnRva2VuID0gdmFsLmRhdGFcbiAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHZhbC5kYXRhXG4gICAgICAgICAgICByZXR1cm4gc3ZjLmdldFVzZXIoKVxuICAgICAgICB9KVxuICAgIH1cbiAgICBzdmMucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gc3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcbiAgICAgICAgfSlcbiAgICB9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnV2ViU29ja2V0U3ZjJywgZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcbiAgICBmdW5jdGlvbiB3ZWJzb2NrZXRIb3N0KCkge1xuICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSBcImh0dHBzOlwiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJ3c3M6Ly9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJ3czovL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3RcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBjb25uZWN0aW9uXG4gICAgdGhpcy5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh3ZWJzb2NrZXRIb3N0KCkpXG4gICAgICAgIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpXG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5zZW5kID0gZnVuY3Rpb24gKHRvcGljLCBkYXRhKSB7XG4gICAgICAgIHZhciBqc29uID0gSlNPTi5zdHJpZ2lmeSh7dG9waWM6IHRvcGljLCBkYXRhOiBkYXRhfSlcbiAgICAgICAgY29ubmVjdGlvbi5zZW5kKGpzb24pXG4gICAgfVxufSkucnVuKGZ1bmN0aW9uIChXZWJTb2NrZXRTdmMpIHtcbiAgICBXZWJTb2NrZXRTdmMuY29ubmVjdCgpXG59KVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9